<!-- home.html -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="CSS/style.css" type="text/css">
    <!-- <script src="scripts/issueTree.js"></script> -->

    <title>Home</title>
</head>

<body>
    <header id="header">
      <a href="index.html" class="app-name">
        <img src="images/AppIcon_t.png" alt="修理依頼icon">
        <span class="title">お客様サポートアプリ</span>
      </a>
      <span class="welcome"></span>
    </header>
  
    <h1>お困りごと選択</h1>
  
    <div id="contentArea"></div>

    
  <script>    
    // ====== データ定義 ======
    const issueTree = {
      "root": [
        { id: "1", name: "画像不具合", img: "images/画像不具合.png" },
        { id: "5", name: "用紙詰まり", img: "images/JAM.png" }
      ],
      "1": [
        { id: "1-1", name: "黒スジが出る", img: "images/黒スジ.png" },
        { id: "1-2", name: "白スジ・色スジが出る", img: "images/白スジ.png", disabled: true }
      ],
      "1-1": [
        { id: "1-1-1", name: "コピー時・スキャナー時", img: "images/Copy.png" },
        { id: "1-1-2", name: "プリントアウト時", img: "images/Print.png", disabled: true }
      ],
      "1-1-1": {
        faq: [
          { name: "読み取りガラスの清掃方法", url: "https://faq.ricoh.jp/app/answers/detail/a_id/1854" },
          { name: "動画：読み取りガラスの清掃方法", url: "https://2280171.mediaspace.kaltura.com/embed/secure/iframe/entryId/1_6g34w6tm/uiConfId/39251761" }
        ]
      },
      "5": [
        { id: "5-12", name: "頻繁に紙詰まりやしわが発生" },
        { id: "5-1", name: "詰まった紙を取り除きたい" }
      ],
      "5-12": {
        faq: [
          { name: "紙詰まり・しわ Jxxxx番号が表示される原因", url: "https://faq.ricoh.jp/app/answers/detail/a_id/20" }
        ]
      },
      "5-1": {
        faq: [
          { name: "詰まった用紙を取り除く方法", url: "https://faq.ricoh.jp/app/answers/ch_detail/mode/2/a_id/2020" }
        ]
      }
    };
// ====== DOM構築ロジック ======
const contentArea = document.getElementById("contentArea");
let currentLevel = "root";

function renderContent(level) {
  contentArea.innerHTML = "";
  const data = issueTree[level];

  const container = document.createElement("div");
  container.className = "issueContainer";
  const h1 = document.querySelector("h1");

  // topRow：戻る＋依頼する
  if (level !== "root") {
    const topRow = document.createElement("div");
    topRow.className = "topRow";

    const backBtn = document.createElement("button");
    backBtn.className = "backBtn";
    backBtn.textContent = "←";
    backBtn.onclick = () =>
      renderContent(level.includes("-") ? level.slice(0, level.lastIndexOf("-")) : "root");

    topRow.appendChild(backBtn);

    // FAQを持つページのみ「依頼する」ボタンを追加
    if (data.faq) {
      const requestBtn = document.createElement("a");
      requestBtn.href = "contactPerson.html?from=faq";
      requestBtn.className = "btn requestBtn";
      requestBtn.textContent = "依頼する";
      topRow.appendChild(requestBtn);
    }

    container.appendChild(topRow);

  } else if (level === "root") {
    // ルート階層専用の戻るボタン
    const topRow = document.createElement("div");
    topRow.className = "topRow";

    const backBtn = document.createElement("button");
    backBtn.className = "backBtn";
    backBtn.textContent = "←";
    backBtn.onclick = () => history.back();

    topRow.appendChild(backBtn);
    container.appendChild(topRow);
  }

  // FAQ表示ページ
  if (data.faq) {
    if (h1) h1.textContent = "関連するコンテンツ";

    const faqList = document.createElement("div");
    faqList.className ="insideContent";
    faqList.innerHTML = `<p>ご選択いただいた内容は以下の手順で改善する可能性があります。</p>`;
    data.faq.forEach(faq => {
      const btn = document.createElement("button");
      btn.className = "faq-content";
      btn.textContent = faq.name;
      btn.onclick = () =>
        (location.href = `faq.html?link=${encodeURIComponent(faq.url)}`);
      faqList.appendChild(btn);
    });
    container.appendChild(faqList);
  } else {
    if (h1) h1.textContent = "お困りごと選択";
  }


  // ボタンリスト
  if (Array.isArray(data)) {
    data.forEach(issue => {
      const btn = document.createElement("button");
      btn.className = "iconBtn";
      
      if (issue.img) {
        btn.innerHTML = `<img src="${issue.img}" alt="">${issue.name}`;
      } else {
        btn.textContent = issue.name; // 画像がないときは文字のみ
      }
    
    if (issue.disabled) btn.disabled = true;
      btn.onclick = () => renderContent(issue.id);
      container.appendChild(btn);
    });
  }

  contentArea.appendChild(container);
}

renderContent("root");


</script>    
</body>

</html>