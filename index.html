<!-- home.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="CSS/style.css" type="text/css">
  <title>Home</title>
</head>
<body>
  <header id="header">
    <div class="app-name">
      <img src="images/AppIcon_t.png" alt="修理依頼icon">
      <span class="title">お客様サポートアプリ</span>
    </div>
    <span class="welcome"></span>
  </header>
  <!-- issueTree.html へ遷移するボタン風リンク -->
  <h1>メインメニュー</h1>
  <div class="iconContainer">
    <a href="issueTree.html" class="btn horizontal"><img src="images/SR_t.png" alt="修理依頼icon">修理依頼を送る</a>
    <a href="Operation.html" class="btn horizontal"><img src="images/OI_t.png" alt="修理依頼icon">操作問い合わせ</a>
    <a href="#" class="btn horizontal"><img src="images/TR_t.png" alt="修理依頼icon">トナー発注・回収</a>
  </div>  
</body>

<script>
console.log("script loaded");

const params = new URLSearchParams(window.location.search);
const machineSn = params.get("machineSn");
let kisyu = "";
let kiban = "";

if (machineSn) {
  // URLにあるときは毎回更新
  const parts = machineSn.split("-");
  if (parts.length === 2 && parts[0] && parts[1]) {
    [kisyu, kiban] = parts;
    localStorage.setItem("kisyu", kisyu);
    localStorage.setItem("kiban", kiban);
    window.history.replaceState({}, document.title, window.location.pathname);
  } else {
    window.location.replace("machineSn.html");
    return;
  }
} else {
  // URLにmachineSnがない場合、過去の値を利用
  kisyu = localStorage.getItem("kisyu");
  kiban = localStorage.getItem("kiban");
  if (!kisyu || !kiban) {
    window.location.replace("machineSn.html");
    return;
  }
}

const welcomeSpan = document.querySelector(".welcome");
welcomeSpan.innerHTML = `<div class="machineSn">ようこそ<br>${kisyu}-${kiban}さん</div>`;

</script>


</html>


